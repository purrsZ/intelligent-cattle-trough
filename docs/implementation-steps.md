# 实施步骤与进度标记（Implementation Steps） 本文档用于驱动项目逐步落地，包含：阶段拆解、任务清单、状态标记规则、依赖关系与验收标准。开发推进仅需跟随本文件逐项完成并更新状态。 ## 1. 状态标记规则 - 状态字段：`TODO`（未开始）、`DOING`（进行中）、`BLOCKED`（被阻塞）、`REVIEW`（待评审/联调）、`DONE`（已完成） - 每条任务以规范的清单项记录：`- [状态] (ID) 标题 - 负责人 @时间戳`，示例： - `- [DOING] (S1-T3) Monitor 页面骨架 - @2025-08-11` - 若有依赖，使用 `deps:` 标注： - `- deps: S1-T1,
S1-T2` - 若有关联 PR/提交： - `- links: PR#12,
commit:abcd1234` - 若被阻塞，使用 `blocked-by:` 写明外部原因或待决事项： - `- blocked-by: 后端接口 / 设计稿 / 评审`>机器可读规范：任务行以 `- [` 开头；`(阶段-任务ID)` 唯一；紧随一行可选元数据键值对（`deps:`、`links:`、`blocked-by:`）。 ## 2. 阶段与任务清单 ### 阶段0：准备与对齐（S0） - [TODO] (S0-T1) 对齐运行环境（Node LTS、包管理器版本） - @ - [DONE] (S0-T2) 安装基础依赖（react-router-dom、axios、antd、echarts、redux toolkit、react-redux、classnames、dayjs） - @2025-08-11 - [DOING] (S0-T3) 初始化目录骨架（api/components/hooks/pages/store/types/utils） - @2025-08-11 - [TODO] (S0-T4) 配置路径别名（@ ->src，可选） - @ ### 阶段1：应用框架搭建（S1） - [DONE] (S1-T1) 路由搭建：/login、/monitor、默认重定向 - @2025-08-11 - [DONE] (S1-T2) 布局：layouts/MainLayout（侧栏/顶部） - @2025-08-11 - [TODO] (S1-T3) 全局样式与主题（AntD 引入、断点、基础主题） - @ - [DONE] (S1-T4) 错误边界与通用组件（ErrorBoundary/Loading/Empty） - @2025-08-11 - [DONE] (S1-T5) 网络层（api/client.ts：Axios 实例与拦截器） - @2025-08-11 - [DONE] (S1-T6) 全局状态（store/index.ts：Redux Toolkit 配置） - @2025-08-11 - [DONE] (S2-T1) 类型定义（types/api.ts + types/enums.ts：使用新API结构） - @2025-08-17 - [DONE] (S2-T2) 接口封装（api/core.ts：queryDevices / updateDeviceConfig / getDeviceGroupList） - @2025-08-17 - [DONE] (S2-T3) 状态切片（store/deviceSlice.ts：devices/deviceGroups/selectedDeviceIds/filters/loading/error） - @2025-08-17 - [DONE] (S2-T4) 页面容器（pages/monitor/index.tsx：使用新API和数据结构） - @2025-08-17 - [DONE] (S2-T5) 设备卡片（components/device/DeviceCard：展示设备信息、选择状态、告警状态） - @2025-08-17 - [DONE] (S2-T6) 网格容器（components/device/DeviceGrid：响应式网格、分页、多选） - @2025-08-17 - [DONE] (S2-T7) 状态徽标（components/device/AlarmBadge：使用新的告警类型枚举） - @2025-08-17 - [DONE] (S2-T8) 批量温度设置弹窗（components/device/TemperatureBatchModal：表单验证、批量设置） - @2025-08-17 ### 阶段3：交互逻辑与校验（S3） - [DONE] (S3-T1) 多选逻辑（selectedDeviceIds 受控，单选/全选/清空） - @2025-08-17 - [DONE] (S3-T2) 表单校验（min<max、范围限制、空选择拦截） - @2025-08-17 - [DONE] (S3-T3) 成功/失败反馈（message提示、关闭弹窗、刷新、清空选择） - @2025-08-17 - [DONE] (S3-T4) 筛选/搜索（防抖搜索、告警状态筛选、设备组筛选） - @2025-08-17 ### 阶段4：性能优化（S4） - [TODO] (S4-T1) 虚拟滚动（react-window 集成至 TroughGrid） - @ - [TODO] (S4-T2) 渲染优化（React.memo/useCallback） - @ - [TODO] (S4-T3) 网络优化（缓存/请求合并，按需） - @ ### 阶段5：可视化占位（S5） - [TODO] (S5-T1) ECharts 温度/状态占比占位图 - @ ### 阶段6：测试与质量（S6） - [TODO] (S6-T1) 单元测试（TroughCard、TemperatureBatchModal、troughSlice） - @ - [TODO] (S6-T2) API 测试（mock/MSW，成功与失败） - @ - [TODO] (S6-T3) 规范与CI（TS严格、ESLint+Prettier、构建与测试） - @ ### 阶段7：打包与交付（S7） - [TODO] (S7-T1) 区分环境构建（dev/test/prod） - @ - [TODO] (S7-T2) 产物验证（首屏、交互流畅度） - @ ## 3. 验收标准（一期） - Monitor 页面： - 展示名称/当前温度/状态（样式随状态变化） - 支持多选与批量设置，操作成功后刷新并提示 - 响应式适配常见断点（≥1200、≥992、≥768、<768） - 基础框架： - 全局错误边界可捕获渲染异常并展示兜底 - Axios 拦截器统一处理错误；全局 Store/Slice 无明显类型异常 ## 4. 依赖与风险 - 后端接口未就绪：本地 mock（MSW/示例数据） - 数据量大：分页优先，必要时虚拟滚动 - 响应式复杂：提前确定断点与列数映射 ## 5. 更新日志 - @2025-08-11 文档创建：初始化阶段与任务清单、状态标记规则 - @2025-08-17 API架构重构：完全使用新的三个核心接口（获取设备组列表、批量修改设备配置、查询设备），废弃旧的兼容性API，重写所有相关组件和状态管理